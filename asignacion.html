<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Asignacion</title>
    <!-- Link to external CSS stylesheet -->
    <link rel="stylesheet" type = "text/css" href="styles.css"/>
  </head>
  <body>
    <div class="form-container">
      <h1>Asignacion</h1>
      <h2>Ingrese la siguiente informaci√≥n:</h2>
      <!-- The form for user input -->
      <form id="asignacionForm">
        <!-- Hidden input to track the action (save or add) -->
        <input type="hidden" name="action" id="action" value="save">
        <!-- Input field for Asignacion -->
        <div class="form-group">
          <label for="Column_10">Asignacion</label>
          <input type="text" id="Column_10" name="Column_10" required></textarea>
        </div>
        <div class="form-group">
            <label for="Column_11">Schedule Number</label>
            <input type="text" id="Column_11" name="Column_11" ></textarea>
        </div>
        <div class="form-group">
          <label for="Column_12">Duracion: Desde</label>
          <input type= "time" id="Column_12" name="Column_12" step="60" required></textarea>
        </div>
        <div class="form-group">
            <label for="Column_13">Duracion: Hasta</label>
            <input type= "time" id="Column_13" name="Column_13" step="60" required></textarea>
        </div>
        <!-- Section heading for article checkbox selection -->
        <h2>ARTICULO DE LA CONVENCION COLECTIVA</h2>
        <!-- Checkbox groups for different article sections -->
        <div class="checkbox-group">
          <label>27.06 (25%)</label>
          <ul>
            <li><label><input type= "checkbox" name="checkbox1_1" value="Option 1">ESCLUSAJE PD-1 Y PD-2</label></li>
            <li><label><input type= "checkbox" name="checkbox1_2" value="Option 2">ESCLUSAJE CON BUQUE LPG</label></li>
            <li><label><input type= "checkbox" name="checkbox1_3" value="Option 3">ESCLUSAJE CON BUQUE LNG</label></li>
          </ul>
        </div>
        <div class="checkbox-group">
          <label>27.08 (15%)</label>
          <ul>
            <li><label><input type= "checkbox" name="checkbox2_1" value="Option 1">ABORDAR O DESEMBARCAR BAJO MAL TIEMPO</label></li>
            <li><label><input type= "checkbox" name="checkbox2_2" value="Option 2">ABORDAR O DESEMBARCAR EN "ALTA MAR"</label></li>
            <li><label><input type= "checkbox" name="checkbox2_3" value="Option 3">ABORDAR O DESEMBARCAR A ORILLAS DE COSTA</label></li>
            <li><label><input type= "checkbox" name="checkbox2_4" value="Option 4">TRANSBORDAR EQUIPO EN MUELLES RUDIMENTARIOS</label></li>
        </div>
        <div class="checkbox-group">
          <label>27.09 (25%)</label>
          <ul>
            <li><label><input type= "checkbox" name="checkbox3_1" value="Option 1">GUARDIA DE NEBLINA</label></li>
            <li><label><input type= "checkbox" name="checkbox3_2" value="Option 2">NAVEGACION BAJO VISIBILIDAD RESTRINGIDA SEVERA</label></li>
            <li><label><input type= "checkbox" name="checkbox3_3" value="Option 3">NAVEGACION CON FUERTES CORRIENTES HIDROGRAFICAS</label></li>
            <li><label><input type= "checkbox" name="checkbox3_4" value="Option 4">IR MAS ALLA DEL PUNTO DE ENCUENTRO POR MALA VISIBILIDAD</label></li>
            <li><label><input type= "checkbox" name="checkbox3_5" value="Option 5">EXPONERSE A FUERTES OLEAJES O CHORRO DEL BUQUE</label></li>
          </ul>
          </div>
        <div class="checkbox-group">
          <label>29.01(1) ($150.00 X EVENTO)</label>
          <ul>
            <li><label><input type= "checkbox" name="checkbox4_1" value="Option a">BUQUE SIN PROPULSION O GOBIERNO</label></li>
            <li><label><input type= "checkbox" name="checkbox4_2" value="Option b">BUQUES CON VISIBILIDAD RESTRINGIDA</label></li>
            <li><label><input type= "checkbox" name="checkbox4_3" value="Option c">SUBMARINOS, COMPUERTAS, TUBERIAS</label></li>
            <li><label><input type= "checkbox" name="checkbox4_4" value="Option d">ESCOLTA DE BUQUES CON Y SIN PROPULSION EN CUALQUIER LUGAR</label></li>
            <li><label><input type= "checkbox" name="checkbox4_5" value="Option e">CAISSON</label></li>
            <li><label><input type= "checkbox" name="checkbox4_6" value="Option f">REMOCION DE CABLES LINEAS O CUALQUIER OTRO TIPO DE OBSTRUCCION EN ANCLAS</label></li>
            <li><label><input type= "checkbox" name="checkbox4_7" value="Option g">OPERAR DRAGA A.A. ZUBIETA</label></li>
            <li><label><input type= "checkbox" name="checkbox4_8" value="Option j">BARCAZAS DE COMBUSTIBLE</label></li>
            <li><label><input type= "checkbox" name="checkbox4_9" value="Option k">REABASTECIMIENTO DE COMBUSTIBLE Y O ACEITES</label></li>
          </ul>  
        </div>
        <div class="checkbox-group">
          <label>Otros</label>
          <ul>
            <li><label><input type= "checkbox" name="checkbox5" value="Option 1">otros cargos (ver notas)</label></li>
          </ul>
        </div>
        <!-- Buttons to submit or add more entries -->
        <div class="form-group">
            <button type="submit" id="gsbutton" name="gsbutton">Guadar y salir</button>
            <button type="submit" id="anadbutton" name="anadbutton">Anadir otra asignacion</button>
        </div>
      </form>
      <!-- Container to display result or error messages -->
      <div id="result">

      </div>
    </div>
    <!-- JavaScript section for handling form submission and AJAX request -->
    <script>
      // Event listener to handle form submission
      document.getElementById('asignacionForm').addEventListener('submit', function(e) {
        e.preventDefault();// Prevent the form from submitting the default way
        console.log("Form submitted");
        // Change the action based on the button clicked
        if (e.submitter.id === "gsbutton"){
          document.getElementById('action').value = "save";
        } else if (e.submitter.id === "anadbutton"){
          document.getElementById('action').value = "add";
        }
        // Collect form data to be sent to the server
        var formData = new FormData(this);
        // Create a new XMLHttpRequest object for making an AJAX request
        var xhr = new XMLHttpRequest();
        // Open a POST request to the specified URL
        xhr.open('POST', 'https://script.google.com/macros/s/AKfycbzQ8ZjExy4bdkMcy8fZgt9GpGOow1DG0A4YsFfzV0ICV0h9N91W0wDiAwS95hkQh5QpWQ/exec', true);
        // Set up a function that assigns the functionality to the onload event handler that will run once the request has been completed
        xhr.onload = function() {
          if (xhr.status === 200) {
            document.getElementById('result').innerText = 'Submitting data...';
            // Redirect based on the button clicked
            if (e.submitter.id === "gsbutton"){
              window.location.href = 'goodbye.html'; //redirecting to goodbye page
            } else if (e.submitter.id === "anadbutton"){
              alert('Los datos han sido enviados');
              window.location.href = 'asignacion.html'; //redirecting to asignacion page to enter more data
            }  
          } else {
            document.getElementById('result').innerText = 'An error occurred. Please try again.';
          }
        }
        xhr.send(formData); //Send the data collected in a form to a server via an HTTP request
      });
    </script>
    
  </body>
</html>
